devtools::build()
?devtools::build_win
devtools::build_win(version = "R-devel")
library(bsplinePsd)
# Generate basis functions
x = seq(0, 1, length = 256)
knots = sort(c(0, runif(10), 1))
basis = dbspline(x, knots)
# Plot basis functions
plot(x, basis[1, ], type = "l", ylim = c(min(basis), max(basis)))
for (i in 2:nrow(basis)) lines(x, basis[i, ], col = i)
plot(x, basis[1, ], type = "l", ylim = c(min(basis), max(basis)), xlab = NULL)
x = seq(0, 1, length = 256)
knots = sort(c(0, runif(10), 1))
basis = dbspline(x, knots)
# Plot basis functions
plot(x, basis[1, ], type = "l", ylim = c(min(basis), max(basis)))
for (i in 2:nrow(basis)) lines(x, basis[i, ], col = i)
library(beyondWhittle)
library(bspec)
library(ggplot2)
library(grid)
library(gridExtra)
#ar.ex = c(0.9, -0.9, 0.9, -0.9)
ar.ex = 0.9
n = 256
data = arima.sim(n = n, model = list(ar = ar.ex))
data = data - mean(data)
plot(data)
spectrum(data)
lambda = seq(0, pi, length = n / 2 + 1)
truepsd = psd_arma(lambda, ar = ar.ex, ma = numeric(0))
ptm = proc.time()
mcmc = gibbs_NPC(data, 20000, 10000, 2, ar.order = 1)
proc.time() - ptm
pdgrm = empiricalSpectrum(data)$power
pdgrm = pdgrm / 2 / pi
# eta = mean(mcmc$eta)
# fparam = psd_arma(lambda, ar = mean(mcmc$rho), ma = numeric(0))
# f = mcmc$psd.mean
# c.eta = f / fparam ^ eta
eta = median(mcmc$eta)
fparam = psd_arma(lambda, ar = median(mcmc$rho), ma = numeric(0))
f = mcmc$psd.median
c.eta = f / fparam ^ eta
ggdata = data.frame(x = rep(lambda, 3),
y = c(f, fparam, c.eta),
name = c(rep("A", length(lambda)),
rep("B", length(lambda)),
rep("C", length(lambda))))
ggdata$f2 <- factor(ggdata$name, labels = c(expression(f(lambda)),
expression(f[param](lambda)^eta),
expression(c[eta](lambda))))
ggplot(ggdata, aes(x, y)) +
geom_line(linewidth = 2) +
#facet_wrap(~f2, nrow = 3, scales = "free_y", labeller = label_parsed) +
facet_wrap(~f2, nrow = 3, labeller = label_parsed) +
theme_bw() +
ylab("") +
xlab(expression(lambda)) +
theme(text = element_text(size=24))
eta
?legend
library(bsplinePsd)
set.seed(12345)
# Generate AR(1) data with rho = 0.9
n = 128
data = arima.sim(n, model = list(ar = 0.9))
data = data - mean(data)
# Run MCMC (may take some time)
mcmc = gibbs_bspline(data, Ntotal = 10000, burnin = 5000, thin = 1)
require(beyondWhittle)  # For psd_arma() function
freq = 2 * pi / n * (1:(n / 2 + 1) - 1)[-c(1, n / 2 + 1)]  # Remove first and last frequency
psd.true = psd_arma(freq, ar = 0.9, ma = numeric(0), sigma2 = 1)  # True PSD
plot(mcmc)  # Plot log PSD (see documentation of plot.psd)
lines(freq, log(psd.true), col = 2, lty = 3, lwd = 2)  # Overlay true PSD
}
set.seed(1234)
n = 128
data = arima.sim(n, model = list(ar = 0.9))
data = data - mean(data)
set.seed(123456)
n = 128
data = arima.sim(n, model = list(ar = 0.9))
data = data - mean(data)
mcmc = gibbs_bspline(data, Ntotal = 10000, burnin = 5000, thin = 1)
require(beyondWhittle)  # For psd_arma() function
freq = 2 * pi / n * (1:(n / 2 + 1) - 1)[-c(1, n / 2 + 1)]  # Remove first and last frequency
psd.true = psd_arma(freq, ar = 0.9, ma = numeric(0), sigma2 = 1)  # True PSD
plot(mcmc)  # Plot log PSD (see documentation of plot.psd)
lines(freq, log(psd.true), col = 2, lty = 3, lwd = 2)  # Overlay true PSD
